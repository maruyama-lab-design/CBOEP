{'datasets': ['../../data/BENGI/GM12878.CTCF-ChIAPET-Benchmark.v3.tsv', '../../data/BENGI/GM12878.HiC-Benchmark.v3.tsv', '../../data/BENGI/GM12878.RNAPII-ChIAPET-Benchmark.v3.tsv', '../../data/BENGI/HeLa.CTCF-ChIAPET-Benchmark.v3.tsv', '../../data/BENGI/HeLa.HiC-Benchmark.v3.tsv', '../../data/BENGI/HeLa.RNAPII-ChIAPET-Benchmark.v3.tsv'], 'feats_order': ['CTCF', 'DNase', 'H3K4me1', 'H3K4me3', 'H3K36me3', 'H3K9me3', 'H3K27me3'], 'feats_config': '../../data/genomic_features/CTCF_DNase_6histone.500.json', 'bin_size': 500, 'seq_len': 2500000, 'rand_shift': True}
##Wed Aug 25 16:36:01 2021
##command: ../../src/cross_validate.py -c config_500bp.json -o config_500bp_cv
##config: {'data_opts': {'datasets': ['../../data/BENGI/GM12878.CTCF-ChIAPET-Benchmark.v3.tsv', '../../data/BENGI/GM12878.HiC-Benchmark.v3.tsv', '../../data/BENGI/GM12878.RNAPII-ChIAPET-Benchmark.v3.tsv', '../../data/BENGI/HeLa.CTCF-ChIAPET-Benchmark.v3.tsv', '../../data/BENGI/HeLa.HiC-Benchmark.v3.tsv', '../../data/BENGI/HeLa.RNAPII-ChIAPET-Benchmark.v3.tsv'], 'feats_order': ['CTCF', 'DNase', 'H3K4me1', 'H3K4me3', 'H3K36me3', 'H3K9me3', 'H3K27me3'], 'feats_config': '../../data/genomic_features/CTCF_DNase_6histone.500.json', 'bin_size': 500, 'seq_len': 2500000, 'rand_shift': True}, 'model_opts': {'model': 'MultiHeadAttModel', 'cnn_channels': [180], 'cnn_sizes': [11], 'cnn_pool': [10], 'enc_layers': 3, 'num_heads': 6, 'd_inner': 256, 'da': 64, 'r': 32, 'att_C': 0.1, 'fc': [128, 64], 'fc_dropout': 0.2, 'in_dim': 8, 'seq_len': 5000}, 'train_opts': {'valid_chroms': ['chr20', 'chr21', 'chr22', 'chrX'], 'learning_rate': 0.0001, 'batch_size': 128, 'num_epoch': 300, 'patience': 10, 'num_workers': 16, 'use_scheduler': False}}
##sample size: 223810
MultiHeadAttModel(
  (cnn): ModuleList(
    (0): Sequential(
      (0): Conv1d(8, 180, kernel_size=(11,), stride=(1,), padding=(5,))
      (1): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.01)
      (3): MaxPool1d(kernel_size=10, stride=10, padding=0, dilation=1, ceil_mode=False)
    )
  )
  (encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=180, out_features=180, bias=True)
        )
        (linear1): Linear(in_features=180, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=180, bias=True)
        (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=180, out_features=180, bias=True)
        )
        (linear1): Linear(in_features=180, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=180, bias=True)
        (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=180, out_features=180, bias=True)
        )
        (linear1): Linear(in_features=180, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=180, bias=True)
        (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (att_first): Linear(in_features=180, out_features=64, bias=True)
  (att_second): Linear(in_features=64, out_features=32, bias=True)
  (fc): ModuleList(
    (0): Sequential(
      (0): Dropout(p=0.2, inplace=False)
      (1): Linear(in_features=720, out_features=128, bias=True)
    )
    (1): Sequential(
      (0): ReLU()
      (1): Linear(in_features=128, out_features=64, bias=True)
    )
    (2): Sequential(
      (0): ReLU()
      (1): Linear(in_features=64, out_features=1, bias=True)
    )
    (3): Sigmoid()
  )
  (fc_dist): Sequential(
    (0): Linear(in_features=720, out_features=180, bias=True)
    (1): ReLU()
    (2): Linear(in_features=180, out_features=1, bias=True)
  )
)
{'total_param': 931522, 'trainable_param': 931522}
Fold splits(validation): 
  - Fold0: 44956({'chr1': 0.604, 'chr10': 0.138, 'chr15': 0.202, 'chr21': 0.056})
  - Fold1: 45554({'chr19': 0.511, 'chr3': 0.21, 'chr4': 0.079, 'chr7': 0.145, 'chrX': 0.055})
  - Fold2: 44827({'chr13': 0.024, 'chr17': 0.457, 'chr2': 0.234, 'chr22': 0.114, 'chr9': 0.171})
  - Fold3: 44676({'chr12': 0.391, 'chr14': 0.179, 'chr16': 0.25, 'chr18': 0.059, 'chr20': 0.121})
  - Fold4: 43797({'chr11': 0.372, 'chr5': 0.167, 'chr6': 0.358, 'chr8': 0.103})

CV epoch: 0/300	(Wed Aug 25 16:36:02 2021)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9085	0.7463	0.9079	0.6854	(Wed Aug 25 16:39:39 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.8929	0.6792	0.9076	0.7087	(Wed Aug 25 16:43:14 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9124	0.7593	0.9085	0.6868	(Wed Aug 25 16:46:51 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9148	0.7330	0.9051	0.6864	(Wed Aug 25 16:50:27 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9171	0.6266	0.9013	0.7114	(Wed Aug 25 16:54:03 2021)
Epoch000(AUC/AUPR):	0.9061(0.0027)	0.6957(0.0117)
Best epoch 0	(Wed Aug 25 16:54:03 2021)

CV epoch: 1/300	(Wed Aug 25 16:54:03 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9235	0.7546	0.9135	0.7007	(Wed Aug 25 16:57:39 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9399	0.7296	0.9146	0.7323	(Wed Aug 25 17:01:15 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9303	0.7611	0.9152	0.7029	(Wed Aug 25 17:04:52 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9321	0.7862	0.9137	0.7080	(Wed Aug 25 17:08:28 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9395	0.7855	0.9033	0.7158	(Wed Aug 25 17:12:05 2021)
Epoch001(AUC/AUPR):	0.9121(0.0044)	0.7119(0.0114)
Best epoch 1	(Wed Aug 25 17:12:05 2021)

CV epoch: 2/300	(Wed Aug 25 17:12:05 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9337	0.7917	0.9158	0.6992	(Wed Aug 25 17:15:42 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9538	0.8276	0.9156	0.7264	(Wed Aug 25 17:19:17 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9582	0.8424	0.9157	0.7088	(Wed Aug 25 17:22:54 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9338	0.7980	0.9149	0.7162	(Wed Aug 25 17:26:31 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9418	0.8080	0.9031	0.7082	(Wed Aug 25 17:30:07 2021)
Epoch002(AUC/AUPR):	0.9130(0.0050)	0.7118(0.0091)
Wait1 (Wed Aug 25 17:30:07 2021)

CV epoch: 3/300	(Wed Aug 25 17:30:07 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9400	0.7771	0.9165	0.7001	(Wed Aug 25 17:33:44 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9509	0.8375	0.9109	0.7258	(Wed Aug 25 17:37:20 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9695	0.9009	0.9134	0.6974	(Wed Aug 25 17:40:57 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9477	0.8253	0.9119	0.7077	(Wed Aug 25 17:44:34 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9549	0.8457	0.8998	0.7005	(Wed Aug 25 17:48:11 2021)
Epoch003(AUC/AUPR):	0.9105(0.0057)	0.7063(0.0103)
Wait2 (Wed Aug 25 17:48:11 2021)

CV epoch: 4/300	(Wed Aug 25 17:48:11 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9541	0.8198	0.9161	0.7040	(Wed Aug 25 17:51:48 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9543	0.8523	0.9120	0.7170	(Wed Aug 25 17:55:24 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9689	0.8743	0.9088	0.6763	(Wed Aug 25 17:59:00 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9599	0.8378	0.9099	0.6974	(Wed Aug 25 18:02:37 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9673	0.8810	0.8985	0.6905	(Wed Aug 25 18:06:14 2021)
Epoch004(AUC/AUPR):	0.9090(0.0058)	0.6970(0.0136)
Wait3 (Wed Aug 25 18:06:14 2021)

CV epoch: 5/300	(Wed Aug 25 18:06:14 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9625	0.8524	0.9159	0.6951	(Wed Aug 25 18:09:50 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9568	0.8349	0.9076	0.7053	(Wed Aug 25 18:13:25 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9673	0.8762	0.9129	0.6884	(Wed Aug 25 18:17:01 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9582	0.8200	0.9125	0.7034	(Wed Aug 25 18:20:37 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9558	0.8363	0.8982	0.6952	(Wed Aug 25 18:24:14 2021)
Epoch005(AUC/AUPR):	0.9094(0.0062)	0.6975(0.0061)
Wait4 (Wed Aug 25 18:24:14 2021)

CV epoch: 6/300	(Wed Aug 25 18:24:14 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9613	0.8420	0.9119	0.6920	(Wed Aug 25 18:27:50 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9678	0.8738	0.9122	0.7098	(Wed Aug 25 18:31:25 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9754	0.9138	0.9087	0.6843	(Wed Aug 25 18:35:02 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9786	0.9244	0.9116	0.7016	(Wed Aug 25 18:38:38 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9723	0.9076	0.8990	0.6934	(Wed Aug 25 18:42:15 2021)
Epoch006(AUC/AUPR):	0.9087(0.0050)	0.6962(0.0087)
Wait5 (Wed Aug 25 18:42:15 2021)

CV epoch: 7/300	(Wed Aug 25 18:42:15 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9710	0.9225	0.9075	0.6817	(Wed Aug 25 18:45:51 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9774	0.9009	0.9120	0.7197	(Wed Aug 25 18:49:26 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9774	0.9128	0.9030	0.6756	(Wed Aug 25 18:53:03 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9786	0.9305	0.9077	0.6931	(Wed Aug 25 18:56:39 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9764	0.8945	0.8986	0.6897	(Wed Aug 25 19:00:16 2021)
Epoch007(AUC/AUPR):	0.9058(0.0046)	0.6920(0.0151)
Wait6 (Wed Aug 25 19:00:16 2021)

CV epoch: 8/300	(Wed Aug 25 19:00:16 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9753	0.9104	0.9110	0.6980	(Wed Aug 25 19:03:51 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9766	0.8947	0.9069	0.6965	(Wed Aug 25 19:07:27 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9755	0.9280	0.9048	0.6830	(Wed Aug 25 19:11:03 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9777	0.8978	0.9087	0.6919	(Wed Aug 25 19:14:39 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9711	0.9035	0.8926	0.6750	(Wed Aug 25 19:18:17 2021)
Epoch008(AUC/AUPR):	0.9048(0.0065)	0.6889(0.0087)
Wait7 (Wed Aug 25 19:18:17 2021)

CV epoch: 9/300	(Wed Aug 25 19:18:17 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9824	0.9244	0.9033	0.6797	(Wed Aug 25 19:21:53 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9826	0.9226	0.9057	0.7015	(Wed Aug 25 19:25:28 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9822	0.9224	0.9078	0.6755	(Wed Aug 25 19:29:04 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9730	0.8995	0.9064	0.6819	(Wed Aug 25 19:32:41 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9798	0.9184	0.8951	0.6785	(Wed Aug 25 19:36:18 2021)
Epoch009(AUC/AUPR):	0.9037(0.0045)	0.6834(0.0093)
Wait8 (Wed Aug 25 19:36:18 2021)

CV epoch: 10/300	(Wed Aug 25 19:36:18 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9769	0.9257	0.9064	0.6880	(Wed Aug 25 19:39:55 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9846	0.9379	0.9072	0.7078	(Wed Aug 25 19:43:31 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9840	0.9327	0.9079	0.6793	(Wed Aug 25 19:47:07 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9743	0.9021	0.9032	0.6812	(Wed Aug 25 19:50:43 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9836	0.9453	0.8886	0.6555	(Wed Aug 25 19:54:21 2021)
Epoch010(AUC/AUPR):	0.9026(0.0072)	0.6824(0.0168)
Wait9 (Wed Aug 25 19:54:21 2021)

CV epoch: 11/300	(Wed Aug 25 19:54:21 2021)
  - Fold0:train(AUC/AUPR)/vald(AUC/AUPR):	0.9819	0.9146	0.9040	0.6945	(Wed Aug 25 19:57:57 2021)
  - Fold1:train(AUC/AUPR)/vald(AUC/AUPR):	0.9861	0.9193	0.9067	0.7009	(Wed Aug 25 20:01:33 2021)
  - Fold2:train(AUC/AUPR)/vald(AUC/AUPR):	0.9832	0.9236	0.9052	0.6761	(Wed Aug 25 20:05:09 2021)
  - Fold3:train(AUC/AUPR)/vald(AUC/AUPR):	0.9824	0.9505	0.9086	0.6905	(Wed Aug 25 20:08:45 2021)
  - Fold4:train(AUC/AUPR)/vald(AUC/AUPR):	0.9908	0.9596	0.8865	0.6598	(Wed Aug 25 20:12:22 2021)
Epoch011(AUC/AUPR):	0.9022(0.0080)	0.6844(0.0147)
Early stopped (Wed Aug 25 20:12:22 2021)
Best epoch/AUC/AUPR: 1	0.9121	0.7119
